<?php
//---------------Ú©ÛŒØ¨ÙˆØ±Ø¯------------------//
$key['start'] = [
    '/start'
];

$key['price'] = [
    "ðŸ“Š Ù‚ÛŒÙ…Øª Ø®Ø¯Ù…Ø§Øª",
    "/price"
];

$key['order'] = [
    "ðŸ› Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´",
    "/buy"
];

$key['info'] = [
    "ðŸ‘¤ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø­Ø³Ø§Ø¨",
    "/info"
];

$key['payment'] = [
    "ðŸ’³ Ø´Ø§Ø±Ú˜ Ø­Ø³Ø§Ø¨",
    "/charge"
];

$key['support'] = [
    "ðŸ“¬ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ",
    "/support"
];

$key['status'] = [
    "ðŸ’¾ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ",
    "/status"
];

$key['free'] = [
    "ðŸ’Ž Ø´Ø§Ø±Ú˜ Ø±Ø§ÛŒÚ¯Ø§Ù†",
    "/free"
];

$key['share_contact'] = "âœ… ØªØ§ÛŒÛŒØ¯ Ø´Ù…Ø§Ø±Ù‡";
$key['back'] = "ðŸ”™ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ";
$key['back_to_before'] = "ðŸ”™ Ù…Ù†ÙˆÛŒ Ù‚Ø¨Ù„ÛŒ";
$key['join_channel'] = "â˜‘ï¸ Ø¹Ø¶ÙˆÛŒØª Ø¯Ø± Ú©Ø§Ù†Ø§Ù„";
$key['ozv'] = "âœ… Ø¹Ø¶Ùˆ Ø´Ø¯Ù…";
$key['payment_offline'] = "ðŸ’³ Ú©Ø§Ø±Øª Ø¨Ù‡ Ú©Ø§Ø±Øª";
$key['payment_online'] = "ðŸ’¸ Ù¾Ø±Ø¯Ø§Ø®Øª Ø¢Ù†Ù„Ø§ÛŒÙ†";
$key['change_gift_balance'] = "ðŸ”„ ØªØ¨Ø¯ÛŒÙ„ Ø¯Ø±Ø¢Ù…Ø¯ Ø¨Ù‡ Ù…ÙˆØ¬ÙˆØ¯ÛŒ";
$key['withdraw_balance'] = "ðŸ’° Ø¨Ø±Ø¯Ø§Ø´Øª Ù…ÙˆØ¬ÙˆØ¯ÛŒ";
$key['balance'] = "ðŸ’µ Ù…ÙˆØ¬ÙˆØ¯ÛŒ ðŸ’µ";
$key['status_order'] = ["ðŸ” Ù¾ÛŒÚ¯ÛŒØ±ÛŒ Ø³ÙØ§Ø±Ø´", "/orderstatus"];
$key['last_order'] = ["ðŸ›’ Ø³ÙØ§Ø±Ø´Ø§Øª Ø§Ø®ÛŒØ±", "/lastorder"];
$key['last_payment'] = ["ðŸ’¸ ØªØ±Ø§Ú©Ù†Ø´ Ù‡Ø§ÛŒ Ø§Ø®ÛŒØ±", "/lastcharge"];
$key['close_key'] = "âŒ Ø¨Ø³ØªÙ† Ù„ÛŒØ³Øª";
$key['product'] = "âœï¸ Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„";
$key['list_price'] = "ðŸ’¸ Ù‚ÛŒÙ…Øª Ù…Ø­ØµÙˆÙ„";
$key['back_price'] = "ðŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª";
$key['cancel_order'] = "âŒ Ù„ØºÙˆ Ø³ÙØ§Ø±Ø´";
$key['ok_order'] = "âœ… ØªØ§ÛŒÛŒØ¯ Ø³ÙØ§Ø±Ø´";
$key['ok'] = "âœ… ØªØ§ÛŒÛŒØ¯ Ù…ÛŒÚ©Ù†Ù…";
$key['start_bot'] = "ðŸ¤– ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø±Ø¨Ø§Øª";
$key['not_product'] = "âŒ Ù…Ø­ØµÙˆÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯";
$key['status_order_inline'] = "ðŸ” Ù¾ÛŒÚ¯ÛŒØ±ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø³ÙØ§Ø±Ø´";
$key['fast_support'] = 'âš¡ï¸ Ù¾Ø§Ø³Ø® Ø³Ø±ÛŒØ¹';
$key['next_page'] = 'âž¡ï¸ ØµÙØ­Ù‡ Ø¨Ø¹Ø¯';
$key['prev_page'] = 'â¬…ï¸ ØµÙØ­Ù‡ Ù‚Ø¨Ù„';
$key['move_balance'] = 'ðŸ’° Ø§Ù†ØªÙ‚Ø§Ù„ Ù…ÙˆØ¬ÙˆØ¯ÛŒ';
$key['charge_code'] = 'ðŸ’Ž Ø«Ø¨Øª Ú©Ø¯ Ø´Ø§Ø±Ú˜';
$key['link_payment'] = 'ðŸ‘‡ðŸ»Ù„ÛŒÙ†Ú© Ù¾Ø±Ø¯Ø§Ø®ØªðŸ‘‡ðŸ»';
$key['support_panel'] = ['ðŸ” | Ù¾ÛŒÚ¯ÛŒØ±ÛŒ Ø³ÙØ§Ø±Ø´Ø§Øª', 'ðŸ’¸ | Ù¾ÛŒÚ¯ÛŒØ±ÛŒ ØªØ±Ø§Ú©Ù†Ø´ Ù‡Ø§', 'ðŸ‘¨â€ðŸ’» | Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ù…Ø¯ÛŒØ±ÛŒØª', 'âœ³ï¸ | Ø³Ø§ÛŒØ± Ù…ÙˆØ§Ø±Ø¯', 'â­•ï¸ | Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ØŒØ§Ù†ØªÙ‚Ø§Ø¯ Ùˆ Ø´Ú©Ø§ÛŒØª'];
$key['gift_code'] = 'ðŸŽ Ø§Ø¹Ù…Ø§Ù„ Ú©Ø¯ ØªØ®ÙÛŒÙ';
$key['back_to_payment'] = 'ðŸ’µ Ø¨Ø±Ú¯Ø´Øª Ø¨Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª';
$key['fast_order'] = 'ðŸ’Ž Ø³ÙØ§Ø±Ø´ Ù…Ø­ØµÙˆÙ„ ðŸ’Ž';
$key['panel_admin'] = 'â€â€¢ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª â€¢';
$key['ok_move_balance'] = 'âœ… ØªØ§ÛŒÛŒØ¯ Ø§Ù†ØªÙ‚Ø§Ù„';
//---------------Ú©ÛŒØ¨ÙˆØ±Ø¯------------------//
trait user_keyboard
{
    function keys($keys, $data = null)
    {
        global $key, $key_admin, $section_status, $admin, $settings;
        switch ($keys) {
            case 'home':
                if ($section_status['main']['free'] == 1) {
                    $t = ['keyboard' => [
                        [['text' => $key['price'][0]], ['text' => $key['order'][0]]],
                        [['text' => $key['info'][0]], ['text' => $key['payment'][0]]],
                        [['text' => $key['support'][0]], ['text' => $key['status'][0]], ['text' => $key['free'][0]]],
                    ]];
                    if ($admin) {
                        $t['keyboard'][] = [['text' => $key['panel_admin']]];
                    }
                } else {
                    $t = ['keyboard' => [
                        [['text' => $key['price'][0]], ['text' => $key['order'][0]]],
                        [['text' => $key['info'][0]], ['text' => $key['payment'][0]]],
                        [['text' => $key['support'][0]], ['text' => $key['status'][0]]],
                    ]];
                    if ($admin) {
                        $t['keyboard'][] = [['text' => $key['panel_admin']]];
                    }
                }
                break;
            case 'request_contact':
                $t = ['keyboard' => [
                    [['text' => $key['share_contact'], 'request_contact' => true]],
                    [['text' => $key['back']]],
                ]];
                break;
            case 'back':
                $t = [
                    'keyboard' => [
                        [['text' => $key['back']]],
                    ]
                ];
                break;
            case 'back_to_before':
                $t = [
                    'keyboard' => [
                        [['text' => $key['back']], ['text' => $key['back_to_before']]],
                    ]
                ];
                break;
            case 'ok_order':
                $t = [
                    'keyboard' => [
                        [['text' => $key['ok_order']]],
                        [['text' => $key['cancel_order']], ['text' => $key['back_to_before']]],
                    ]
                ];
                break;
            case 'ok_panel':
                $t = [
                    'keyboard' => [
                        [['text' => $key['ok']]],
                        [['text' => $key['back']]],
                    ]
                ];
                break;
            case 'shop_keyboard':
                $result = $data[0];
                $c = $data[1];
                $depth = $data[2];
                $currentIndex = $data[3];
                if ($depth == 'product') {
                    $displaySettings = json_decode($settings['display_products'], true);
                } else {
                    $displaySettings = ($depth === null)
                        ? json_decode($settings['display_category'], true)
                        : json_decode($settings['display_sub_category'], true);
                }
                $previousIndex = $currentIndex - $displaySettings['page'];
                $nextIndex = $currentIndex + $displaySettings['page'];

                foreach ($result as $button) {
                    $button['name'] = json_decode($button['name']);
                    $t[] = [['text' => $button['name']]];
                }

                $t = row_chunk($t, $displaySettings['row']);

                if ($c > $displaySettings['page']) {
                    if ($previousIndex < 0) {
                        $t[] = [['text' => $key['next_page']]];
                    } elseif ($c > $nextIndex) {
                        $t[] = [['text' => $key['prev_page']], ['text' => $key['next_page']]];
                    } elseif ($c <= $nextIndex) {
                        $t[] = [['text' => $key['prev_page']]];
                    }
                }

                $t[] = [['text' => $key['back']], ['text' => $key['back_to_before']]];

                $t = ['keyboard' => $t];
                break;
            case 'price_info':

                $result = $data['0'];
                $c = $data['1'];
                $depth = $data['2'];
                $currentIndex = $data['3'];

                $depth = ($depth == '') ? 0 : $depth;

                $displaySettings = ($depth === 0)
                    ? json_decode($settings['display_category'], true)
                    : json_decode($settings['display_sub_category'], true);

                $previousIndex = $currentIndex - $displaySettings['page'];
                $nextIndex = $currentIndex + $displaySettings['page'];

                foreach ($result as $button) {
                    $button['name'] = json_decode($button['name']);
                    $t[] = [['text' => $button['name'], 'callback_data' => 'price_info_category_show_' . $button['id']]];
                }

                $t = row_chunk($t, $displaySettings['row']);

                if ($c > $displaySettings['page']) {

                    if ($previousIndex < 0) {
                        $t[] = [['text' => $key['next_page'], 'callback_data' => 'price_info_category_page_' . $depth . '_' . $nextIndex]];
                    } elseif ($c > $nextIndex) {
                        $t[] = [['text' => $key['prev_page'], 'callback_data' => 'price_info_category_page_' . $depth . '_' . $previousIndex], ['text' => $key['next_page'], 'callback_data' => 'price_info_category_page_' . $depth . '_' . $nextIndex]];
                    } elseif ($c < $nextIndex) {
                        $t[] = [['text' => $key['prev_page'], 'callback_data' => 'price_info_category_page_' . $depth . '_' . $previousIndex]];
                    }

                    if ($depth) {
                        $t[] = [['text' => $key['back_price'], 'callback_data' => 'price_info_category_back_' . $depth], ['text' => $key['close_key'], 'callback_data' => 'close']];
                    } else {
                        $t[] = [['text' => $key['close_key'], 'callback_data' => 'close']];
                    }
                } else {
                    if ($depth) {
                        $t[] = [['text' => $key['back_price'], 'callback_data' => 'price_info_category_back_' . $depth], ['text' => $key['close_key'], 'callback_data' => 'close']];
                    } else {
                        $t[] = [['text' => $key['close_key'], 'callback_data' => 'close']];
                    }
                }

                $t = ['inline_keyboard' => $t];
                break;
            case 'price_info_products':
                $result = $data['0'];
                $c = $data['1'];
                $depth = $data['2'];
                $currentIndex = $data['3'];

                $displaySettings = json_decode($settings['display_products'], true);

                $previousIndex = $currentIndex - $displaySettings['page'];
                $nextIndex = $currentIndex + $displaySettings['page'];

                foreach ($result as $button) {
                    $button['name'] = json_decode($button['name']);
                    $t[] = [['text' => $button['name'], 'callback_data' => 'price_info_product_show_' . $button['id']]];
                }
                $t = row_chunk($t, $displaySettings['row']);

                if ($c > $displaySettings['page']) {

                    if ($previousIndex < 0) {
                        $t[] = [['text' => $key['next_page'], 'callback_data' => 'price_info_product_page_' . $depth . '_' . $nextIndex]];
                    } elseif ($c > $nextIndex) {
                        $t[] = [['text' => $key['prev_page'], 'callback_data' => 'price_info_product_page_' . $depth . '_' . $previousIndex], ['text' => $key['next_page'], 'callback_data' => 'price_info_product_page_' . $depth . '_' . $nextIndex]];
                    } elseif ($c < $nextIndex) {
                        $t[] = [['text' => $key['prev_page'], 'callback_data' => 'price_info_product_page_' . $depth . '_' . $previousIndex]];
                    }

                    if ($depth) {
                        $t[] = [['text' => $key['back_price'], 'callback_data' => 'price_info_category_back_' . $depth], ['text' => $key['close_key'], 'callback_data' => 'close']];
                    } else {
                        $t[] = [['text' => $key['close_key'], 'callback_data' => 'close']];
                    }
                } else {
                    if ($depth) {
                        $t[] = [['text' => $key['back_price'], 'callback_data' => 'price_info_category_back_' . $depth], ['text' => $key['close_key'], 'callback_data' => 'close']];
                    } else {
                        $t[] = [['text' => $key['close_key'], 'callback_data' => 'close']];
                    }
                }


                $t = ['inline_keyboard' => $t];
                break;
            case 'product_info':
                $result = $data;
                $t[] = [['text' => $key['fast_order'], 'callback_data' => 'price_info_product_order_' . $result['id']]];

                $t[] = [['text' => $key['back_price'], 'callback_data' => 'price_info_product_back_' . $result['category_id']], ['text' => $key['close_key'], 'callback_data' => 'close']];
                $t = ['inline_keyboard' => $t];
                break;
            case 'last_order':
                $c   = $data['0'];
                $page = $data['1'];
                $bef = $data['2'];
                $nex = $data['3'];
                if ($c > $page) {
                    if ($bef < 0) {
                        $t[] = [['text' => $key['close_key'], 'callback_data' => 'close'], ['text' => $key['next_page'], 'callback_data' => 'userorder_' . $nex]];
                    } elseif ($c > $nex) {
                        $t[] = [['text' => $key['prev_page'], 'callback_data' => 'userorder_' . $bef], ['text' => $key['close_key'], 'callback_data' => 'close'], ['text' => $key['next_page'], 'callback_data' => 'userorder_' . $nex]];
                    } elseif ($c < $nex) {
                        $t[] = [['text' => $key['prev_page'], 'callback_data' => 'userorder_' . $bef], ['text' => $key['close_key'], 'callback_data' => 'close']];
                    }
                } else {
                    $t[] = [['text' => $key['close_key'], 'callback_data' => 'close']];
                }
                $t = ['inline_keyboard' => $t];
                break;
            case 'last_payment':
                $c   = $data['0'];
                $page = $data['1'];
                $bef = $data['2'];
                $nex = $data['3'];
                if ($c > $page) {
                    if ($bef < 0) {
                        $t[] = [['text' => $key['close_key'], 'callback_data' => 'close'], ['text' => $key['next_page'], 'callback_data' => 'userpayment_' . $nex]];
                    } elseif ($c > $nex) {
                        $t[] = [['text' => $key['prev_page'], 'callback_data' => 'userpayment_' . $bef], ['text' => $key['close_key'], 'callback_data' => 'close'], ['text' => $key['next_page'], 'callback_data' => 'userpayment_' . $nex]];
                    } elseif ($c < $nex) {
                        $t[] = [['text' => $key['prev_page'], 'callback_data' => 'userpayment_' . $bef], ['text' => $key['close_key'], 'callback_data' => 'close']];
                    }
                } else {
                    $t[] = [['text' => $key['close_key'], 'callback_data' => 'close']];
                }
                $t = ['inline_keyboard' => $t];
                break;
            case 'lock_channel':
                $channel = $data[0];
                if (isset($data[1])) {
                    $referral_id = $data[1];
                    $t = ['inline_keyboard' => [
                        [['text' => $key['join_channel'], 'url' => "https://t.me/" . $channel]],
                        [['text' => $key['ozv'], 'callback_data' => 'ref_join' . $referral_id]]
                    ]];
                } else {
                    $t = ['inline_keyboard' => [
                        [['text' => $key['join_channel'], 'url' => "https://t.me/" . $channel]],
                        [['text' => $key['ozv'], 'callback_data' => 'ozv']]
                    ]];
                }
                break;

            case 'status_order_inline':
                $code = $data;
                $t = ['inline_keyboard' => [
                    [['text' => $key['status_order_inline'], 'callback_data' => "orderstatus_" . $code]],
                ]];
                break;
            case 'back_to_payment':
                $t = ['inline_keyboard' => [
                    [['text' => $key['back_to_payment'], 'callback_data' => 'backcoin_' . $data]]
                ]];
                break;
            case 'payment_gateways':
                $result = $data['0'];
                $amount = $data['1'];
                $domin = $data['2'];
                $code = $data['3'];
                $t[] = [['text' => $this->text('link_payment'), 'callback_data' => 'fyk']];
                foreach ($result as $pa) {
                    $t[] = [['text' => $this->text('payment_key', [$amount, $pa['name']]), 'url' => "https://" . $domin . "/payment/index.php?file=" . $pa['file'] . "&code=" . $code . "&action=get"]];
                }
                if($section_status['payment']['gift_code']){
                    $t[] = [['text' => $key['gift_code'], 'callback_data' => "gift_code_" . $code]];
                }
                $t = ['inline_keyboard' => $t];
                break;
            case 'payment':
                $status = $data;
                if ($status['payment']['offline_payment']) {
                    $t[] = [['text' => $key['payment_offline']]];
                }
                if ($status['payment']['online_payment']) {
                    $t[] = [['text' => $key['payment_online']]];
                }
                if ($status['payment']['move_balance']) {
                    $t[] = [['text' => $key['move_balance']]];
                }
                if($section_status['payment']['gift_charge']){
                    $t[] = [['text' => $key['charge_code']]];
                }
                $t = row_chunk($t, [2]);
                $t[] = [['text' => $key['back']]];
                $t = ['keyboard' => $t];
                break;
            case 'gift':
                $t = [
                    'keyboard' => [
                        [['text' => $key['balance']]],
                        [['text' => $key['withdraw_balance']], ['text' => $key['change_gift_balance']]],
                        [['text' => $key['back']]],
                    ]
                ];
                break;
            case 'status':
                $t = [
                    'keyboard' => [
                        [['text' => $key['status_order'][0]]],
                        [['text' => $key['last_order'][0]], ['text' => $key['last_payment'][0]]],
                        [['text' => $key['back']]],
                    ]
                ];
                break;
            case 'support_panel':
                $t = [
                    'keyboard' => [
                        [['text' => $key['support_panel'][0]], ['text' => $key['support_panel'][1]]],
                        [['text' => $key['support_panel'][2]], ['text' => $key['support_panel'][3]]],
                        [['text' => $key['support_panel'][4]]],
                        [['text' => $key['back']]],
                    ]
                ];
                break;
            case 'ok_move_balance':
                $t = [
                    'keyboard' => [
                        [['text' => $key['ok_move_balance']]],
                        [['text' => $key['back']]],
                    ],
                ];
                break;
            case 'remove':
                $t = ['remove_keyboard' => true];
                break;
            default:
                $t = null;
                break;
        }
        if (isset($t['keyboard'])) {
            $t = array_merge(array_slice($t, 0), ['resize_keyboard' => true], array_slice($t, 0));
            return $t;
        } else {
            return $t;
        }
    }
}
